{% extends 'layout.html' %}
{% block title %}Edit Profil | GreenGrowth{% endblock %}

{% block article %}
<section class="w-full min-h-screen bg-[#F5F7FA]">

  <!-- ================= COVER ================= -->
  <div class="relative w-full">
    <a href="{{ url_for('profile_user.view_profile', user_id=profile.user_id) }}"
       class="group absolute bg-[#0BDAAA] rounded-full top-3 left-3 inline-flex items-center gap-3 text-sm font-semibold text-black">
      <span class="w-9 h-9 flex items-center justify-center rounded-full border border-[#0BDAAA]
                   group-hover:bg-[#0BDAAA] transition">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
             stroke-width="2" stroke="currentColor"
             class="w-4 h-4 group-hover:text-black">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
        </svg>
      </span>
    </a>
    <div
      class="w-full h-56 bg-cover bg-center"
      style="background-image:url('https://images.unsplash.com/photo-1500530855697-b586d89ba3ee')">
    </div>

    <!-- AVATAR -->
    <div class="absolute left-10 bottom-0 translate-y-1/2">
      <div class="relative w-40 h-40">
        <img
          id="preview"
          src="{{ profile.foto_user or 'https://cdn-icons-png.flaticon.com/512/892/892781.png' }}"
          class="w-40 h-40 rounded-full border-4 border-white object-cover shadow-lg"
        >
        <label for="fotoInput"
          class="absolute bottom-2 right-2 bg-white p-2 rounded-full shadow cursor-pointer hover:bg-gray-100 transition">
          ✏️
        </label>
      </div>
    </div>

    <input
      id="fotoInput"
      type="file"
      name="foto_user"
      accept="image/*"
      class="hidden"
      form="editProfileForm"
      onchange="previewImage(event)">
  </div>

  <!-- ================= CONTENT ================= -->
  <div class="max-w-6xl mx-auto px-10 pt-26 pb-20">

    <!-- HEADER + SAVE BUTTON SEJAJAR DENGAN AVATAR -->
    <div class="flex items-center mb-6 gap-8">
      <!-- Spacer untuk avatar -->
      <div class="w-30"></div>

      <!-- Judul + tombol -->
      <div class="flex-1 flex items-center justify-between">
        <h2 class="text-2xl font-semibold text-gray-700">Personal details</h2>
        <div class="mt-2">
        <button
          type="submit"
          form="editProfileForm"
          class=" py-2 rounded-full border border-[#0BDAAA]
                 text-[#0BDAAA] hover:bg-[#0BDAAA] hover:text-white transition">
          Save changes
        </button>
        </div>
      </div>
    </div>

    <!-- FORM GRID -->
    <form
      id="editProfileForm"
      method="POST"
      action="{{ url_for('profile_user.edit_profile', user_id=profile.user_id) }}"
      enctype="multipart/form-data"
      class="grid grid-cols-1 md:grid-cols-2 gap-6 bg-white p-8 rounded-2xl shadow-lg">

      {% set input = "w-full px-4 py-2.5 rounded-md border border-gray-300 focus:ring-2 focus:ring-[#0BDAAA] focus:outline-none bg-white" %}

      <div>
        <label class="text-sm text-gray-500">Nama Lengkap</label>
        <input name="nama_user" value="{{ profile.nama_user or '' }}" class="{{ input }}" required>
      </div>

      <div>
        <label class="text-sm text-gray-500">Email</label>
        <input name="email_user" value="{{ profile.email_user or '' }}" readonly class="{{ input }} bg-gray-100">
      </div>

      <div>
        <label class="text-sm text-gray-500">Jenis Kelamin</label>
        <select name="gender" class="{{ input }}">
          <option value="">Pilih</option>
          <option value="male" {% if profile.gender=='male' or profile.gender=='Laki-laki' %}selected{% endif %}>Laki-laki</option>
          <option value="female" {% if profile.gender=='female' or profile.gender=='Perempuan' %}selected{% endif %}>Perempuan</option>
        </select>
      </div>

      <div>
        <label class="text-sm text-gray-500">Tanggal Lahir</label>
        <input type="date" name="tanggal_lahir"
               value="{{ profile.tanggal_lahir or '' }}" class="{{ input }}">
      </div>

      <div>
        <label class="text-sm text-gray-500">Pendidikan Tertinggi</label>
        <select name="pendidikan_tertinggi" class="{{ input }}">
          <option value="">Pilih</option>
          <option value="High School" {% if profile.pendidikan_tertinggi=='High School' %}selected{% endif %}>High School</option>
          <option value="Diploma" {% if profile.pendidikan_tertinggi=='Diploma' %}selected{% endif %}>Diploma</option>
          <option value="Bachelor" {% if profile.pendidikan_tertinggi=='Bachelor' %}selected{% endif %}>Bachelor</option>
          <option value="Master" {% if profile.pendidikan_tertinggi=='Master' %}selected{% endif %}>Master</option>
        </select>
      </div>

      <div>
        <label class="text-sm text-gray-500">Softskill</label>
        <input name="softskill" value="{{ profile.softskill or '' }}" class="{{ input }}">
      </div>

      <div>
        <label class="text-sm text-gray-500">Hardskill</label>
        <input name="hardskill" value="{{ profile.hardskill or '' }}" class="{{ input }}">
      </div>

      <div>
        <label class="text-sm text-gray-500">Pengalaman</label>
        <input name="pengalaman" value="{{ profile.pengalaman or '' }}" class="{{ input }}">
      </div>

      <div>
        <label class="text-sm text-gray-500">No HP</label>
        <input name="no_hp" value="{{ profile.no_hp or '' }}" class="{{ input }}">
      </div>

      <div class="md:col-span-2">
        <label class="text-sm text-gray-500">Alamat</label>
        <textarea name="alamat" rows="3" class="{{ input }}">{{ profile.alamat or '' }}</textarea>
      </div>

    </form>
  </div>
</section>

<script>
function previewImage(event) {
  const file = event.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = () => {
    document.getElementById('preview').src = reader.result;
  };
  reader.readAsDataURL(file);
}
</script>
{% endblock %}
